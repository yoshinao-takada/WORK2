<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="347px" preserveAspectRatio="none" style="width:789px;height:347px;" version="1.1" viewBox="0 0 789 347" width="789px" zoomAndPan="magnify"><defs><filter height="300%" id="f166yvh18z4jd0" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="16" cy="171.5" fill="#000000" filter="url(#f166yvh18z4jd0)" rx="10" ry="10" style="stroke:none;stroke-width:1.0;"/><ellipse cx="767" cy="171.5" fill="none" filter="url(#f166yvh18z4jd0)" rx="10" ry="10" style="stroke:#000000;stroke-width:1.0;"/><ellipse cx="767.5" cy="172" fill="#000000" rx="6" ry="6" style="stroke:none;stroke-width:1.0;"/><rect fill="#FEFECE" filter="url(#f166yvh18z4jd0)" height="328.7813" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="532" x="94" y="7"/><rect fill="#FFFFFF" height="259.9844" rx="12.5" ry="12.5" style="stroke:#FFFFFF;stroke-width:1.0;" width="526" x="97" y="72.7969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="94" x2="626" y1="69.7969" y2="69.7969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="94" x2="626" y1="34.6094" y2="34.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="341" y="26.5332">Active</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="50" x="99" y="47.0664">enter: Init</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="66" x="99" y="62.1602">exit: Destroy</text><g id="Active.empty"><rect fill="#FEFECE" filter="url(#f166yvh18z4jd0)" height="67.7969" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="193" x="153" y="81.7969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="153" x2="346" y1="109.4063" y2="109.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38" x="230.5" y="101.3301">empty</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="173" x="158" y="126.8633">exit: remove header from queue</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="158" y="141.957">do: trigger(get)</text></g><g id="Active.had_header"><rect fill="#FEFECE" filter="url(#f166yvh18z4jd0)" height="97.9844" rx="12.5" ry="12.5" style="stroke:#A80036;stroke-width:1.5;" width="287" x="106" y="219.7969"/><line style="stroke:#A80036;stroke-width:1.5;" x1="106" x2="393" y1="247.4063" y2="247.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="211" y="239.3301">had_header</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="234" x="111" y="264.8633">enter: parse header, clear header in queue</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="247" x="111" y="279.957">empty: parse payload, clear payload in queue</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="243" x="135" y="295.0508">dispatch parsed packet info if packet is valid.</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="80" x="111" y="310.1445">do: trigger(get)</text></g><!--MD5=[b2b78756cb54a7b7bab7a0f1b210dde3]
link empty to empty--><path d="M346.4,105.0669 C357.09,107.1069 364,110.6869 364,115.7969 C364,120.0269 359.26,123.2069 351.56,125.3369 " fill="none" id="empty-to-empty" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="346.4,126.5269,356.0653,128.4193,351.2741,125.412,354.2815,120.6208,346.4,126.5269" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="436.5" y="104.792">Evt(get),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="380" y="121.1436">sleep(1-packet-header time)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="370" y="137.4951">[len(data) &lt; len(packet header)]</text><!--MD5=[8cd19cf193bb381ae48255de5a4385f1]
link empty to had_header--><path d="M163.08,150.0669 C157.02,155.1869 151.66,161.0569 147.5,167.7969 C136.8,185.1069 143.44,201.5869 157.4,216.0069 " fill="none" id="empty-to-had_header" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="161.1,219.6169,157.4718,210.4607,157.5289,216.1172,151.8724,216.1744,161.1,219.6169" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="44" x="217" y="182.292">Evt(get)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="148.5" y="198.6436">[len(data) &gt; len(packet header)]</text><!--MD5=[539663343051ee542d29dfeeeffed3e5]
reverse link empty to had_header--><path d="M319.76,153.4769 C323.94,157.8069 327.61,162.5669 330.5,167.7969 C340.49,185.8869 332.68,203.9669 318.64,219.6669 " fill="none" id="empty-backto-had_header" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="316.14,149.9369,319.7865,159.0858,319.718,153.4294,325.3745,153.361,316.14,149.9369" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="402" y="182.292">Evt(get),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="335.5" y="198.6436">[len(data) &lt; len(packet header)]</text><!--MD5=[59d7de38e1e4d59e220adcf33819f51d]
link had_header to had_header--><path d="M393.08,256.9269 C404.17,259.5469 411,263.5069 411,268.7969 C411,273.2569 406.13,276.7769 397.95,279.3469 " fill="none" id="had_header-to-had_header" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="393.08,280.6669,402.8146,282.1627,397.9045,279.3537,400.7135,274.4436,393.08,280.6669" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48" x="487.5" y="266.292">Evt(get),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="417" y="282.6436">[len(data) &gt;= len(packet header)]</text><!--MD5=[edb54b3b19a9924369663c95443e5f29]
link *start to Active--><path d="M26.3,171.5 C38.61,171.5 61.07,171.5 88.74,171.5 " fill="none" id="*start-to-Active" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="93.96,171.5,84.96,167.5,88.96,171.5,84.96,175.5,93.96,171.5" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31" x="44.5" y="164.9951">Evt(*)</text><!--MD5=[86d12920a26e7a6e6b0df510e416084d]
link Active to *end--><path d="M626.08,171.5 C680.45,171.5 728.21,171.5 751.65,171.5 " fill="none" id="Active-to-*end" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="756.81,171.5,747.81,167.5,751.81,171.5,747.81,175.5,756.81,171.5" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="644.5" y="164.9951">Evt(end-request)</text><!--MD5=[9d23b72926c1d990986d40323bb969fd]
@startuml
[*] -> Active : Evt(*)
Active -> [*] : Evt(end-request)
state Active {
    empty : exit: remove header from queue
    empty : do: trigger(get)
    empty -> empty : Evt(get),\nsleep(1-packet-header time)\n[len(data) < len(packet header)]
    empty -down-> had_header : Evt(get)\n[len(data) > len(packet header)]
    had_header : enter: parse header, clear header in queue
    had_header : empty: parse payload, clear payload in queue
    had_header : \tdispatch parsed packet info if packet is valid.
    had_header : do: trigger(get)
    had_header -up-> empty : Evt(get),\n[len(data) < len(packet header)]
    had_header -> had_header : Evt(get),\n[len(data) >= len(packet header)]
}
Active : enter: Init
Active : exit: Destroy
@enduml

PlantUML version 1.2021.00(Sun Jan 10 19:25:05 JST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>